<div>

    <div ng-if="(isCameraInactive && showVideo)" class="noCamBar stripe">
        <span class="animateCamBar">{{'ALLOW_CAMERA' | translate}}</span>
    </div>

    <div class="aligner" ng-show="showStart" ng-if="mode !== 'save'">

        <div class="bigPlay">
            <div>
                <a class="playButton" ng-click="startFun();">{{'CARNIVALIZE_YOURSELF' | translate}}</a>
            </div>
        </div>

    </div>


    <div class="aligner">


<!-- VIDEO STATUS MESSAGES *************************** -->
        <div class="messages" ng-show="cameraMsg.msg">
            <i class="icon {{cameraMsg.icon}}"></i>
            <p ng-bind-html="cameraMsg.msg"></p>
        </div>

        <div class="imgWrap onVideo" ng-if="mode === 'save' && cameraMsg.msg === ''">
            <div class="imgCover" ></div>
            <div class="imgMenu" >
                 <div class="formMask">

                    <div class="el center">
                        <label>{{'SAVE_MASK' | translate}}</label>
                    </div>

                    <div class="el center">
                        <div class="radio">
                            <input id="safe" type="radio" ng-model="selectedMask.audience" name="gender" value="1">
                            <label class="xxxA" for="safe">{{'SAFE' | translate}}</label>
                            <input id="rude" type="radio"  ng-model="selectedMask.audience" name="gender" value="2">
                            <label class="xxxB" for="rude">{{'RUDE' | translate}}</label>
                            <input id="nokids" type="radio"  ng-model="selectedMask.audience" name="gender" value="3">
                            <label class="xxxC" for="nokids">{{'ADULT' | translate}}</label>
                            <input id="hardcore" type="radio" ng-model="selectedMask.audience" name="gender" value="4">
                            <label class="xxxD" for="hardcore">{{'XXX' | translate}}</label>     
                        </div>
                    </div>

                    <div>
                        <div class="el center" ng-show="selectedMask.audience">
                            <input maxlength="100"  type="text" ng-model="selectedMask.tags" ng-list placeholder="{{'PLACEHOLDER_TAGS' | translate}}">
                        </div>
                        <div class="el center" ng-show="selectedMask.audience && (selectedMask.tags.length>=2)">
                            <input maxlength="100"  type="text" ng-model="selectedMask.credits" placeholder="{{'PLACEHOLDER_CREDITS' | translate}}">
                        </div>
                        <div class="el center" ng-show="selectedMask.audience && (selectedMask.tags.length>=1) && selectedMask.credits.length>5">
                            <div class="wrap">
                                <input maxlength="80" type="email" ng-model="selectedMask.email" placeholder="{{'PLACEHOLDER_MAIL' | translate}}">
                            </div>
                        </div>
                        <div class="el center"  ng-show="selectedMask.audience && (selectedMask.tags.length>=1)">
                            <a class="btn" ng-click="saveMaskOnDB(selectedMask);">{{'SAVE_MASK' | translate}}</a>
                        </div>
                        <div class="el center">
                            <a class="btn small important" ng-click="goTo('/editor');">{{'MODIFY_MASK' | translate}}</a>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <div class="videoBlock" ng-show="(!isCameraInactive && showVideo)">
            

<!-- SEARCH MASK *************************** -->
        <div ng-show="showSearchMask" tags-input="searchInput" update-tags="updateMasksAmountAndTags()" search-masks></div>




<!-- CHANGE MASK *************************** -->
            <div class="changeMask" ng-show="isRunning && mode !== 'save' && masks.length > 1">
                <div class="roundBtn left" ng-click="changeMask(1);"></div>
                <div class="roundBtn right" ng-click="changeMask(-1);"></div>
            </div>



<!-- CONTROLS (buttons) *************************** -->
            <div class="controls" ng-show="showControls">
                <!-- <div class="control calibrate" ng-click="refreshTracking();" ng-show="isRunning"></div> -->
                <div ng-if="masktags" class="control masktags" ng-click="alert('Catch All!');" ng-show="!showSearchMask && isRunning && (mode !== 'save') && cameraMsg.msg === ''">
                    {{masktags ? masktags : '...'}}  <br/> <em>{{masktagsAmount}} {{'MASKS_FOUND' | translate}}</em> &mdash; <a ng-click="resetMasksAmountAndTags();">{{'REMOVE_TAGS' | translate}}</a>
                </div>
                
                <div class="control masktags" ng-click="showSearchMask = !showSearchMask" ng-show="!masktags && !showSearchMask && isRunning && (mode !== 'save') && cameraMsg.msg === ''">
                    <em>{{'TOTAL_MASKS' | translate}}: {{masktagsAmount}}</em> &mdash; <a>{{'SEARCH_BY_TAGS' | translate}}</a>
                </div>

                <div class="control mask" ng-click="showSearchMask = !showSearchMask" ng-show="!showSearchMask && isRunning && (mode !== 'save') && cameraMsg.msg === ''"></div>
                <div class="control image" ng-click="canvasToImage();" ng-show="isRunning && showImage && (mode !== 'save')"></div>
                <div class="control empty" ng-hide="isRunning && showImage"></div>
                <div class="videoProgress" ng-show="mode !== 'save' && isRunning">
                    <div class="progress" style="width: {{GIFprogress}}">
                        <div class="framesCounter" ng-if="pics>0">
                            <span ng-if="pics>=2" ng-click="resetVideo();">
                                reset 
                            </span>
                            {{pics}}/10
                        </div>
                    </div>
                </div>
                <div class="control video" ng-class="{active: pics>0}" ng-click="canvasToGif();"    ng-show="isRunning && (mode !== 'save')"></div>
                <div class="control pause" ng-click="stopTracking();"   ng-show="isRunning"></div>
                <div class="control play" ng-click="restartTracking();" ng-hide="isRunning"></div>
                <!-- <div class="control loading"><span class="spinning"></span></div> -->
            </div>




<!-- fullPic (video canvas + overlay) *************************** -->
            <div id="fullPic" width="{{videoWidth}}" height="{{videoHeight}}">
                <canvas id="compare"></canvas>
                <canvas ng-if="showMask" id="overlay"></canvas>
                <div id="watermark">http://carnivalize.me</div>
                <video id="vid" autoplay loop></video>
            </div>

        </div>

    </div>




<!-- find mask and re-calibrate buttons *************************** -->
    <div class="aligner" ng-show="(!isCameraInactive && showVideo)">
        <div class="credits minimenu"> 
            <a ng-click="showSearchMask = !showSearchMask" ng-show="isRunning && (mode !== 'save') && cameraMsg.msg === ''"> {{'FIND_MASKS' | translate}} </a>
            <div class="right">
                {{'MASK_NO_FIT' | translate}} <strong><a ng-click="refreshTracking();">{{'RECALIBRATE_FACE_DETECT' | translate}}</a></strong>
            </div>
        </div>
    </div>




<!-- credits *************************** -->
    <div class="aligner" ng-if="selectedMask.credits.length">
        <div class="credits"> 
            CREDITS <span ng-bind-html="selectedMask.credits | linky"></span>
        </div>
    </div>





<!-- create MASK button *************************** -->
    <!-- 
    <div class="aligner" ng-show="mode !== 'save' && !showStart">
        <div class="formMask">
            <div class="el center">
                <a class="btn" ng-click="goTo('/editor');">{{'CREATE_MASK' | translate}}</a>
            </div>
        </div>
    </div>
    -->
    


<!-- clear storage (DEBUG) button *************************** -->
<!--
    <div class="aligner" ng-if="mode !== 'save'">
        <a ng-click="clearStorage();">clearStorage</a>
    </div>
-->
<!--
    <pre style="max-width: 640px;overflow: scroll;font-size: 12px;background: #f1f1f1;word-wrap: break-word; max-height:600px;font-family:monospace;letter-spacing: 1px;">
        {{selectedMask}}
    </pre>
-->





<!-- previously taken PHOTOS *************************** -->
    <div class="aligner gray" ng-if="images.length > 0">
        <div class="textBlock">
            <h2 class="white">Your Temporary Images</h2>
            <p class="white">
                These images are only available until your next refresh.<br/>
                To preserve these images you can anonimously save them to the carnival<br/>
                or <em>Right Click</em> on the ones you like, to store them on your computer.
            </p>
        </div>
    </div>
    <div class="userImages aligner" ng-if="images.length > 0">
        <ul>
            <li ng-repeat="img in images | orderBy:'ts':true"> <!-- | orderBy:'ts':true -->
                <personal-image></personal-image>
            </li>
        <ul>
    </div>
</div>